{% extends "admin/base_site.html" %}
{% load static %}
{% load i18n %}
{% block extrastyle %}{{ block.super }}{% endblock %}
{% block bodyclass %}{{ block.super }} monobank-statement{% endblock %}
{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/2.2.2/css/dataTables.bootstrap5.css">
  <link rel="stylesheet" type="text/css" href="{% static 'adminpanel/css/main.css' %}"> <!--Custom CSS-->
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/2.2.2/js/dataTables.js"></script>
  <script src="https://cdn.datatables.net/2.2.2/js/dataTables.bootstrap5.js"></script>
  <script src="{% static 'bank/js/main.js' %}"></script> <!--Custom JS-->
{% endblock %}
{% block title %}Виписка Monobank {{ block.super }}{% endblock %}
{% block coltype %}flex{% endblock %}

{% if not is_popup %}
  {% block nav-breadcrumbs %}
    <div class="breadcrumbs">
      <a href="{% url 'admin:index' %}">{% translate 'Home' %}</a> &rsaquo;
      <a href="../">{% translate 'Bank' %}</a> &rsaquo; Виписка Monobank
    </div>
  {% endblock %}
{% endif %}

{% block content %}
  <p class="fs-5">Виписка Monobank</p>
  <div class="container-fluid">
    <div class="row">
      <!-- Form -->
      <div id="toolbar">
        <form method="post" class="">
          {% csrf_token %}
          <div class="d-flex align-items-center gap-2 mb-3">
            <div class="form-group">{{ form.client_token }}</div>
            <div class="form-group">{{ form.card_id }}</div>
            <div class="form-group">{{ form.date_from }}</div>
            <div class="form-group">{{ form.date_to }}</div>
            <div class="form-group">
              <button type="submit" class="btn btn-sm custom-btn">Отримати виписку</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="row">
      <!-- Errors -->
      {% if form.errors or errors %}
        <div class="alert alert-danger">
          <strong>Помилка!</strong>
          <ul>
            {% for field in form %}
              {% if field.errors %}
                <li>{{ field.errors }}</li>
              {% endif %}
            {% endfor %}
            {% if errors %}
              <li>{{ errors }}</li>
            {% endif %}
          </ul>
        </div>
      {% endif %}

      <!-- Main Table -->
      <div class="col-md-9 col-lg-12">
        <div class="table-responsive">
          <table style="width:100%" class="order-column" id="statement">
            <caption></caption>
            <thead>
            <tr>
              <th>#</th>
              <th>Дата</th>
              <th>Опис транзакції</th>
              <th>Сума</th>
              <th>Комісія</th>
              <th>Коментар</th>
              <th>Баланс</th>
            </tr>
            </thead>
            <tbody>
            {% for item in transactions %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.time }}</td>
                <td>{{ item.description }}</td>
                <td>{{ item.amount }}</td>
                <td>{{ item.commission|floatformat:2 }}</td>
                <td>{{ item.comment }}</td>
                <td>{{ item.balance }}</td>
              </tr>
            {% endfor %}
            </tbody>
            <tfoot>
            <tr>
              <th colspan="6" style="text-align:right">Всього:</th>
              <th>{{ transactions|length }}</th>
            </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
